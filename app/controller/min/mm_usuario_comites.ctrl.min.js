var app=angular.module("app",[]);app.controller("mainController",["$scope","$http",function(e,o){e.form_title="Usuario y comites",e.form_btnNuevo="Nuevo registro",e.form_btnEdita="Edita",e.form_btnElimina="Elimina",e.form_btnAnula="Cerrar",e.form_btnExcel="Exporta Excel",e.form_btnActualiza="Actualizar",e.form_titModal="Actualiza lista de registros",e.form_Phbusca="Consulta",e.form_uc_id="ID",e.form_uc_empresa="EMPRESA",e.form_uc_comiteId="COMITE",e.form_uc_usuarioId="USUARIO",e.form_Phuc_id="Digite id",e.form_Phuc_empresa="Digite empresa",e.form_Phuc_comiteId="Digite comiteid",e.form_Phuc_usuarioId="Digite usuarioid",e.currentPage=0,e.pageSize=10,e.pages=[],e.registro=[],e.empresa=$("#e").val();var r={uc_id:0,uc_empresa:e.empresa,uc_comiteId:0,uc_usuarioId:0};function a(r){o.post("modulos/mod_mm_usuario_comites.php?op=r",{op:"r",empresa:r}).success(function(o){e.details=o,e.configPages()})}!function(r){o.post("modulos/mod_mm_usuario_comites.php?op=0",{op:"0",empresa:r}).success(function(o){e.operators0=o}),o.post("modulos/mod_mm_usuario_comites.php?op=1",{op:"1",empresa:r}).success(function(o){e.operators1=o})}(e.empresa),a(e.empresa),e.configPages=function(){e.pages.length=0;var o=e.currentPage-4,r=e.currentPage+5;o<1?(o=1,r=Math.ceil(e.details.length/e.pageSize)>10?10:Math.ceil(e.details.length/e.pageSize)):o>=Math.ceil(e.details.length/e.pageSize)-10&&(o=Math.ceil(e.details.length/e.pageSize)-10,r=Math.ceil(e.details.length/e.pageSize)),o<1&&(o=1);for(var a=o;a<=r;a++)e.pages.push({no:a});e.currentPage>=e.pages.length&&(e.currentPage=e.pages.length-1)},e.setPage=function(o){e.currentPage=o-1},e.formToggle=function(){$("#idForm").slideToggle(),e.uc_id=0,$("#idForm").css("display","none")},e.show_form=!0,e.formToggle=function(){$("#idForm").slideToggle(),e.formato.$setPristine(),e.registro=angular.copy(r)},e.editInfo=function(o){e.registro=o,$("#idForm").slideToggle()},e.exporta=function(){valor=confirm("Exporta la tabla de inmuebles y propietarios a Excel, continua?"),1==valor&&(empresa=$("#e").val(),o.post("modulos/mod_mm_usuario_comites.php?op=exp",{op:"exp",empresa:empresa}).success(function(e){$("#miExcel").html(e),alert("exporta a Excel. Cargue y renombre el documento... "),window.open("data:application/vnd.ms-excel,"+encodeURIComponent($("#miExcel").html()))}))},e.deleteInfo=function(e){empresa=$("#e").val(),confirm("Desea borrar el registro con nombre : "+e.uc_comiteId+" ?")&&o.post("modulos/mod_mm_usuario_comites.php?op=b",{op:"b",uc_id:e.uc_id}).success(function(e){"Ok"===e&&(a(empresa),alert("Registro Borrado "))})},e.updateInfo=function(e){er="",empresa=$("#e").val(),""===$("#uc_id").val()&&(er+="falta id\n"),""===$("#uc_empresa").val()&&(er+="falta empresa\n"),""===$("#uc_comiteId").val()&&(er+="falta comiteid\n"),""===$("#uc_usuarioId").val()&&(er+="falta usuarioid\n"),""==er?o.post("modulos/mod_mm_usuario_comites.php?op=a",{op:"a",uc_id:e.uc_id,uc_empresa:e.uc_empresa,uc_comiteId:e.uc_comiteId,uc_usuarioId:e.uc_usuarioId}).success(function(e){"Ok"===e&&(a(empresa),alert("Registro Actualizado "),$("#idForm").slideToggle())}):alert(er)},e.clearInfo=function(e){console.log("empty"),$("#idForm").slideToggle()}}]),app.filter("startFromGrid",function(){return function(e,o){return o=+o,e.slice(o)}});


